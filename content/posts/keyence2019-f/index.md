---
title: "キーエンス プログラミング コンテスト 2019 F - Paper Cutting"
date: 2020-09-26
tags: [atcoder]
links:
  - label: "Problem link"
    url: "https://atcoder.jp/contests/keyence2019/tasks/keyence2019_f"
  - label: "My Submission"
    url: "https://atcoder.jp/contests/keyence2019/submissions/16541370"
---

## 問題

縦に $w$ 本、横に $h$ 本の直線が引かれた長方形の紙がある。

これから $k$ 回、「まだ選んでいない直線を 1 つ選び、その直線に沿って紙を切る」という操作を行う。一度操作を行う毎に、スコアに紙の破片の個数が加算される。

全ての操作列に対するスコアの総和を求めよ。

### 制約

- $1 \\leq h, w \\leq 10\^7$
- $1 \\leq k \\leq h + w$

## 考察

左から $x$ 本目、上から $y$ 本目の直線の交点を $(x, y)$ とする。なお紙の左端、上端を便宜上 $0$ 本目とする。

各 $0 \\leq x \\leq w, 0 \\leq y \\leq h$ について、「 $(x, y)$ を左上隅とする破片が何回カウントされるか」を求めることにする。
ちょうど $m$ 回目にこの破片が生成された場合、 $k - m + 1$ 回カウントされることになる。よってこの $m$ を全探索することにする。

### $x, y \\geq 1$ の場合

前 $m$ 本のうちに特定の 2 本が含まれていなければならない。うち片方が $m$ 本目となるような操作列の個数は以下で求められる。

$$
2 (m - 1) \\cdot (h + w - 2)\^\{\\underline\{k - 2\}\}
$$

なおこのような $(x, y)$ は計 $hw$ 個ある。

### $x = y = 0$ の場合

最初から切り出されているので、 $m = 0$ のときのみ $(h + w)\^\{\\underline\{k\}\}$ 通り、他は $0$ 通りとなる。

### それ以外の場合

$m$ 本目が特定の 1 本であるような操作列の個数は以下で求められる。他の $k - 1$ 本を $h + w - 1$ 本から選ぶと考えればよい。

$$
(h + w - 1)\^\{\\underline\{k - 1\}\}
$$

なおこのような $(x, y)$ は計 $h + w$ 個ある。

## 実装例

{{<code file="0.cpp" language="cpp">}}
