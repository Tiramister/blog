---
title: "yukicoder No.1211 円環はお断り"
date: 2020-08-30
tags: [yukicoder]
links:
  - label: "Problem link"
    url: "https://yukicoder.me/problems/no/1211"
  - label: "My Submission"
    url: "https://yukicoder.me/submissions/544810"
---

## 問題

$n$ 個の珠からなる円環状の数珠がある。ある珠を起点として $i$ 番目の珠の価値は $a\_i$ である。

この数珠に $k$ 個の切れ目を入れ、紐状の数珠 $k$ 本に分割する。
各数珠の価値は、その数珠に含まれる珠の価値の総和に等しい。

数珠の価値の最小値の最大値を求めよ。

### 制約

- $1 \\leq k \\leq n \\leq 10\^5$
- $1 \\leq a\_i \\leq 10\^9$

## 考察

「最小値の最大化」ということで二分探索を考える。つまり「価値が $x$ 以上の数珠 $k$ 個に分割できるか？」という問題を考える。

もし珠 $i - 1$ と $i$ の間に切れ目を入れることが決まっていれば、円環状ではなく紐状の数珠を分割する問題となる。
この問題は貪欲法で解くことができる。つまり左端から総和が $x$ 以上である最短の数珠を切り出し続けて、 $k$ 本以上の数珠が作れれば OK となる。

これを各 $i$ について高速に行う。
まず $d\_i$ を「 $[i, i + d)$ の総和が $x$ 以上となる最小の $d$ 」と定める。これを用いると、上の解法は「 $i \\leftarrow i + d\_i$ を $k$ 回繰り返すと $d\_i$ の総和が $n$ を超えるか判定する」と言い換えられる。
なお $d\_i$ の計算は尺取法により $\\Theta(n)$ で行える。

この「 $i \\leftarrow i + d\_i$ を $k$ 回繰り返す」という部分を**ダブリング**で高速化する。つまり $f\^m(i)$ を「 $i \\leftarrow i + d\_i$ を $2\^m$ 回繰り返したときの $d\_i$ の総和」とし、これを利用して適当にスキップする。

これで各 $i$ について判定を $\\Theta(\\log k)$ で行えるので、 $f\^m(i)$ の前計算含め、 $x$ に対する判定問題を $\\Theta(n \\log k)$ で解ける。
以上より、全体の計算量は $\\Theta(n \\log k \\log \\sum a\_i)$ となる。

## 実装例

{{<code file="0.cpp" language="cpp">}}
