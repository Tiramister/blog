---
title: "AtCoder Grand Contest 019 C - Fountain Walk"
date: 2018-09-12
tags: [atcoder]
links:
  - label: "Problem"
    url: https://atcoder.jp/contests/agc019/tasks/agc019_c
---

## 概要

x 軸方向と y 軸方向にそれぞれ $10\^8$ 本の道が $100m$ 間隔で直交するように通っている(要は $100m$ 間隔のだだっ広いグリッドがある)。

この道の交差点上に $N$ 個の噴水がそれぞれ $(X\_i, Y\_i)$ に置かれている。噴水は半径 $10m$ の円形をしていて、その外周に道が通っている。また **1 つの道上に 2 つ以上の噴水が置かれていることはない** 。

このとき、 $(x\_1, y\_1)$ から $(x\_2, y\_2)$ へ移動するための最短距離を求めよ。

{{<image src="0.png" width="50%">}}

### 制約

- $0 \\leq x\_1, y\_1, x\_2, y\_2, X\_i, Y\_i \\lt 10\^8$
- $1 \\leq N \\leq 2 \\times 10\^5$
- $i \\neq j$ のとき、 $X\_i \\neq X\_j$ **かつ** $Y\_i \\neq Y\_j$
- スタートとゴールに噴水は置かれていない

## 解説

適当に上下左右判定することで、 $x\_1 \\leq x\_2$ かつ $y\_1 \\leq y\_2$ のケースに帰着できる。

最短経路ということで、まず x 正方向と y 正方向に移動することだけ考えればいい。
よって $(x\_1, y\_1)$ と $(x\_2, y\_2)$ を対頂角とする長方形に入っていない噴水は無視していい。

そういったルートの中で、できるだけ多く噴水で曲がるようなルートを探すことを考える。
1 つのルートで 2 つの噴水 $i, j$ で曲がることができる条件は、 $X\_i < X\_j$ かつ $Y\_i < Y\_j$ が成立することである。
つまり任意の 2 つがこれを満たす最大の噴水の集合を見つければいい。
そしてこれは、 $X\_i$ について昇順にソートすれば、 $Y\_i$ の **最長増加部分列** となる。
有名問題なので解き方は割愛。

最後に、この問題にはコーナーケースが存在する。それが「曲がる回数が長方形の幅と同じケース」である。

{{<image src="1.png">}}

この場合、必ず 1 回は噴水を突っ切る必要があるため、その分のロスが生じる。

## 実装例

{{<code file="0.cpp" language="cpp">}}
