---
title: "AtCoder Beginner Contest 116 D - Various Sushi"
date: 2019-01-20
tags: [atcoder]
links:
  - label: "Problem"
    url: https://atcoder.jp/contests/abc116/tasks/abc116_d
  - label: "My Submission"
    url: https://atcoder.jp/contests/abc116/submissions/34692730
---

## 概要

$N$ 個の寿司がある。 $i$ 個目の種類は $t\_i$ で、美味しさは $d\_i$ である。

あなたはこの寿司から $K$ 個を選んで食べる。このとき、全体の美味しさは以下の 2 つの値の和で表される。

- 選んだ寿司の $d\_i$ の総和。
- $x$ 種類の寿司を選んだとき、 $x\^2$ 。

全体の美味しさの最大値を求めよ。

### 制約

- $1 \\leq K \\leq N \\leq 10\^5$
- $1 \\leq t\_i \\leq N$
- $1 \\leq d\_i \\leq 10\^9$

## 解説

まず $d\_i$ が大きい方から貪欲に選んでみる。これで $d\_i$ の総和は最大になるが、種類数 $x$ が最適とは限らない。

そこで、ここから種類数を増やしていく。種類数を増やすには、既に選んだ中から 1 つ捨てて、まだ選ばれていない種類から 1 つ選べばいい。

捨てるものは美味しさが最小のものを選ぶのが最善だが、種類数が減らないように気をつける必要がある。
つまりその種類最後の寿司の場合は、捨てずにスキップする。

一方で選ぶものは、その種類で美味しさが最大のものを選ぶべきである。
よって、美味しさが最大のものを貪欲に選んでいくのが最善となる。

## 実装例

{{<code file="0.cpp" language="cpp">}}
