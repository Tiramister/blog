---
title: AtCoder Regular Contest 083 E - Bichrome Tree
date: 2020-11-27
tags: [atcoder, arc]
links:
  - label: Problem link
    url: https://atcoder.jp/contests/arc083/tasks/arc083_c
  - label: My Submission
    url: https://atcoder.jp/contests/arc083/submissions/18401250
---

## 問題

$N$ 頂点の根付き木が与えられる。
これからこの木の各頂点に、非負整数と白か黒の色を割り当てる。

長さ $N$ の整数列 $(X\_i)$ が与えられる。
以下が各頂点 $v$ について満たされるような割り当てが存在するか判定せよ。

- $v$ を根とする部分木内で、 $v$ と同じ色の頂点に割り当てられた非負整数の和が $X\_v$ となる。

### 制約

- $1 \\leq N \\leq 10\^3$
- $0 \\leq X\_i \\leq 5 \\cdot 10\^3$

## 考察

根から再帰的に解くことを考える。対称性から、根には黒が割り当てられているとしてよい。

まず根の各子 $v$ に対して、 $v$ を根とする部分木に割り当てができるかを判定する。できなかったら答えは「不可能」となる。
できる場合、「$v$ が黒の割り当て」と、それを反転した「$v$ が白の割り当て」のどちらかを採用することになる。

ここで「$v$ と異なる色の和として考えうるものの集合」が分かれば、

- 「黒い頂点の和」をキー
- 「白い頂点の和として考えうるものの集合」を値

とするナップザック DP で、白い頂点の和が全パターン分かる。
しかしこれでは計算量が大きすぎる。

実は、以下の理由で「$v$ と異なる色の和」は常に最小値を選べばよい。

- 「$v$ が白の割り当て」を選ぶ場合、黒い頂点の和が小さい方が自由度が高い。
- 「$v$ が黒の割り当て」を選ぶ場合、白い頂点の和が小さい方が後で上のケースを採用したときに自由度が高くなる。

後はナップザック DP を「白い頂点の和の最小値」を値に持つように変更すればよい。計算量は $O(N \\max\\\{X\_i\\\})$ となる。

## 実装例

{{<code file="main.cpp" language="cpp">}}
