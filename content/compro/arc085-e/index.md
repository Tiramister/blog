---
title: AtCoder Regular Contest 085 E - MUL
date: 2020-11-27
tags: [atcoder, arc]
links:
  - label: Problem link
    url: https://atcoder.jp/contests/arc085/tasks/arc085_c
  - label: My Submission
    url: https://atcoder.jp/contests/arc085/submissions/18417672
---

## 問題

$1$ から $N$ が書かれた $N$ 個の宝石がある。 $i$ が書かれた宝石の価値は $a\_i$ である(負の場合もある)。

これから以下の操作を好きなだけ行う。

- 正整数 $x$ を選び、 $x$ の倍数が書かれた宝石を全て壊す。

壊れずに残った宝石の価値の総和の最大値を求めよ。

### 制約

- $1 \\leq N \\leq 100$
- $|a\_i| \\leq 10^9$

## 考察

こればかりは知らないとどうにもならない気がする。

この問題は、以下のように言い換えられる。

> - 宝石 $i$ を壊すと $0$ の報酬が得られる。
> - 宝石 $i$ を壊さないと $a\_i$ の報酬が得られる。
> - $y$ が $x$ の倍数 $(y \\gt x)$ であるとき、宝石 $x$ を壊して $y$ を壊さないと $\\infty$ の罰則(実質禁止)。
>
> というルール下で、報酬 $-$ 罰則を最大化せよ。

このように「集合を 2 つに分けて報酬を最大化する」という形式の問題は、俗に「燃やす埋める問題」とか「Project Selection Problem」とか呼ばれる有名問題で、最小カットによって解くことができる。

ただし、このままでは $a\_i \\lt 0$ の場合に容量が負の辺が出現してしまう。
そこで十分大きい $M$ で下駄を履かせる必要がある。つまり、

- 宝石 $i$ を壊すと $M$ の報酬が得られる。
- 宝石 $i$ を壊さないと $a\_i + M$ の報酬が得られる。

と変更して、解から $NM$ を引けばよい。

## 実装例

{{<code file="main.cpp" language="cpp">}}
