---
title: "AtCoder Regular Contest 107"
date: 2020-11-01
tags: [atcoder, arc]
links:
  - label: "Contest link"
    url: "https://atcoder.jp/contests/arc107"
---

## 結果

|      |  A   |  B   |   C   |  D  |  E  |  F  |
| :--: | :--: | :--: | :---: | :-: | :-: | :-: |
| time | 1:30 | 6:14 | 13:52 |  -  |  -  |  -  |
|  Δ   | 1:30 | 4:44 | 7:38  |  -  |  -  |  -  |

## 問題

### A - Simple Math

露骨に $\\sum\_\{a\} \\sum\_\{b\} ab = (\\sum\_a a)(\\sum\_b b)$ の形をしているので、素直にやる。

### B - Quadruple

$(a + b) - (c + d) = K$ と見ると、半分全列挙だな〜となる。
$a + b$ を固定すれば $c + d$ も定まるので、 $s = a + b$ なる $(a, b)$ の個数を $O(1)$ で求められれば $\\Theta(N)$ で答えが求まる。

しかしこれを関数として実装しようとすると、微妙な場合分けが入るのであまりやりたくない。
少し考えると、imos 法を使えば各 $s$ に対する $(a, b)$ の個数を $\\Theta(N)$ で簡単に前計算できることに気づく。

### C - Shuffle Permutation

まず「列 swap を何度行っても、 $i$ 行目と $j$ 行目を swap できるか否かは変わらない」ことに気づく。
つまり列 swap と行 swap を独立に考えることができる。

行 swap に着目する。まず $i$ 行目と $j$ 行目を swap できるような $(i, j)$ を $\\Theta(N\^3)$ で全列挙する。
これらを辺とする $N$ 頂点の無向グラフを考えると、連結成分内は自由に並び替えることができる(極大木の葉から決めるいつものやつ)。
ということで、連結成分のサイズの階乗の総積が答えとなる。

行・列で同じコードを 2 回書くのもアレなので、転置をとってループを 2 回回す実装にした。

### D - Number of Multisets

色々な方針を試しても $\\Theta(N\^3)$ から落ちなかったので、残り 50 分くらいで捨てて E に移った。

もっと時間をかければ解けたかもしれないが、解けたところで遅すぎるので、E に多くの時間を費やしてワンチャン狙う方がマシだろうという判断である。
今振り返っても、この判断は正しかったと思う。

要素を $2\^0, 2\^\{-1\}, \\dots$ と順に追加していくことを考える。
このとき、以下を満たす $(i, j, s)$ が状態として欲しくなる。

- 今 $2\^\{-i\}$ を追加している
- 既に $j$ 個使用している
- 総和があと $s \\cdot 2\^\{-i\}$ 足りない

このままでは $\\Theta(N\^3)$ なので状態を落とす必要があるのだが、どれも落とせそうにない。

...というのがコンテスト中に考えていた方針の 1 つなのだが、実は **状態 $i$ を落とせる** 。

上の DP における遷移は、以下の 2 種類である。

- $2\^\{-i\}$ を 1 つ追加する。このとき $j$ が 1 増え、 $s$ が 1 減る。
- $i$ を 1 増やす。このとき $s$ が 2 倍になる。

こうして見ると、巡回する遷移がないので $i$ は別に持たなくてもよいことが分かる。

### E - Mex Mat

コンテスト中はずっと $2$ に着目していた。というのも、 $2$ は $0, 1$ より生成されるパターンが少ないためである。
「実はそのうち $2$ が消えるのでは？」と考えながら色々試した結果、「$2$ の左上は $2$ である」ということに気づく。しかしそこから先はほとんど進展なし。

こういうのはどうすれば安定して解けるようになるのかマジで分からん。
実験が正道なんだろうけど、実験したところで周期性が見えただろうか。
でもとりあえず実験はすべきだった、というのが一番の反省点。

## 反省

- A-C は言うことなし。
- D はシンプルな精進不足。こういうのコドフォに多そう。
- E はとりあえす実験を書く。のときも実験書かなくて後悔したのに、反省が生きていない。
- F に専念すればどうなっていたかも気になるが、どっちみち解けてない気もする。
